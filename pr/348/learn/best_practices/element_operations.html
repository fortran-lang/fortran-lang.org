<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Fortran Programming Language">
    <title>Element-wise Operations on Arrays - Fortran Programming Language</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.0/normalize.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css">
    <script src="https://unpkg.com/feather-icons"></script>
    <link href="/pr/348/assets/css/main.css" rel="stylesheet">
    <link href="/pr/348/assets/css/syntax.css" rel="stylesheet">
    <link rel="canonical" href="https://fortran-lang.org/learn/best_practices/element_operations" />
    <script src="https://kit.fontawesome.com/8d17d4fe97.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/2.0.2/octicons.min.css">
    <link rel="stylesheet" href="/pr/348/assets/github-activity-0.1.5/github-activity-0.1.5.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.7.2/mustache.min.js"></script>
    <script type="text/javascript" src="/pr/348/assets/github-activity-0.1.5/github-activity-0.1.5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js" integrity="sha256-TQq84xX6vkwR0Qs1qH5ADkP+MvH0W+9E7TdHJsoIQiM=" crossorigin="anonymous"></script>
    
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <header class="navbar">
	
	<section class="front-section shaded purple"><div class="container">
		
		<h3>
		<i data-feather="git-pull-request"></i>
		<b>Site preview: </b>you are previewing unpublished changes for
		
		<a href="https://github.com/fortran-lang/fortran-lang.org/pull/348" target="_blank">
			<i class="devicon-github-plain colored"></i>
			pull request 348</a>
		</h3>
	</div></section>
	 
    <div class="container">
        <nav class="navbar">
	    <div class="container-fluid">
	    <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu" aria-expanded="false">
		    <span class="sr-only">Toggle navigation</span>
		    <img src="/pr/348/assets/img/icons/icon-menu.svg" alt="Toggle navigation" class="navbar-top-align">
		</button>
		<a href="/pr/348/" class="navbar-brand">
		    <img src="/pr/348/assets/img/fortran_logo_256x256.png" id="navbar-logo" alt="Fortran">
		</a>
	    </div>
	    <div class="collapse navbar-collapse navbar-top-align" id="menu">
	        <ul class="nav navbar-nav navbar-right">
		
		    
		    <li class="current">
		    
		    <a href="/pr/348/learn/">Learn</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/pr/348/compilers/">Compilers</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/pr/348/community/">Community</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/pr/348/packages">Packages</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/pr/348/news/">News</a>
		    
			</li>
		
		<li>
			<a  href="https://fortran-lang.discourse.group/" target="_blank">
			<i class="fab fa-discourse"></i> <i class="icon-link" >Discourse</i>
			</a>
		</li>
		<li>
			<a href="https://twitter.com/fortranlang" target="_blank">
				<i class="fab fa-twitter"></i> <i class="icon-link" >Twitter</i>
			</a>
		</li>
		<li>
			<a  href="https://github.com/fortran-lang" target="_blank">
				<i class="fab fa-github"></i> <i class="icon-link" >Github</i>
			</a>
		</li>
		<li>
			<a  href="/pr/348/news.xml" target="_blank">
				<i class="fas fa-rss"></i> <i class="icon-link" >RSS Feed</i>
			</a>
		</li>
		</ul>
	    </div>
	    </div>
        </nav>
    </div>
</header>


<section class="front-section">
  <div class="container">

    <div class="col-fixed" id="pagenav-sidebar">

  <!-- Find parent book using page.permalink -->
  <!-- NB. This search is inefficient but simplifies
        the definition of book pages in learning.yml -->
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          
    
  

  <a href="/pr/348/learn#book-index">
    <i class="fas fa-arrow-circle-left"></i>
    Back to Learn Fortran index 
  </a>

  <h3>
  <i class="fas fa-book"></i>
  Fortran Best Practices</h3>

  <div class="content">
   <!-- If this book has multiple pages -->

    

    <ul>
    
    <!-- Add link to book introduction (index) -->
    
      <li><a href="/pr/348/learn/best_practices">
        Introduction</a></li>
    

    <!-- List pages in this book -->
    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/style_guide">
          Fortran Style Guide</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/floating_point">
          Floating Point Numbers</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/integer_division">
          Integer Division</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/modules_programs">
          Modules and Programs</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/arrays">
          Arrays</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/multidim_arrays">
          Multidimensional Arrays</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li>
          <b><a href="/pr/348/learn/best_practices/element_operations">
            Element-wise Operations on Arrays</a></b>
          <ul id="page-nav"></ul>
        </li>
        
        
        
      

    
    
      <!-- Get page title from page metadata -->
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/allocatable_arrays">
          Allocatable Arrays</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/file_io">
          File Input/Output</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/callbacks">
          Callbacks</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/pr/348/learn/best_practices/type_casting">
          Type Casting in Callbacks</a></li>
      

    
    </ul>

  
</div>

</div>



    <div class="newsletter col-right">

      <h1>Element-wise Operations on Arrays</h1>

      <div style="margin-top: 0.5em; margin-bottom: 0.5em;">
        <i></i>
        
      </div>

      <p>There are three approaches to perform element-wise operations on arrays when using subroutines and functions:</p>

<ul>
  <li><code class="highlighter-rouge">elemental</code> procedures</li>
  <li><em>explicit-shape</em> arrays</li>
  <li>implementing the operation for vectors and write simple wrapper
subroutines (that use <code class="highlighter-rouge">reshape</code> internally) for each array shape</li>
</ul>

<p>In the first approach, one uses the <code class="highlighter-rouge">elemental</code> keyword to create a
function like this:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="k">elemental</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mf">1._dp</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w">
</span></code></pre></div></div>

<p>All arguments (in and out) must be scalars. You can then use this
function with arrays of any (compatible) shape, for example:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">)</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">])</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nb">reshape</span><span class="p">([</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]))</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">])</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The output will be:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">3</span><span class="mf">.0000000000000000</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">1.5874010519681994</span><span class="w">        </span><span class="mf">1.7320508075688772</span><span class="w">        </span><span class="mf">1.5848931924611136</span><span class="w">
</span><span class="nl">2</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">1.5874010519681994</span><span class="w">        </span><span class="mf">1.4142135623730951</span><span class="w">        </span><span class="mf">1.3195079107728942</span><span class="w">
</span></code></pre></div></div>

<p>In the above, typically <code class="highlighter-rouge">n</code> is a parameter and <code class="highlighter-rouge">x</code> is the array of an
arbitrary shape, but as you can see, Fortran does not care as long as
the final operation makes sense (if one argument is an array, then the
other arguments must be either arrays of the same shape or scalars). If
it does not, you will get a compiler error.</p>

<p>The <code class="highlighter-rouge">elemental</code> keyword implies the <code class="highlighter-rouge">pure</code> keyword, so the procedure
must be pure. It results that <code class="highlighter-rouge">elemental procedures</code> can only use <code class="highlighter-rouge">pure</code> procedures and have no side effects.</p>

<p>If the elemental procedure algorithm can be made faster using array
operations inside, or if for some reasons the arguments must be arrays of
incompatible shapes, then one should use the other two approaches. One
can make <code class="highlighter-rouge">nroot</code> operate on a vector and write a simple wrapper for
other array shapes, e.g.:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mf">1._dp</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w">

</span><span class="k">function</span><span class="w"> </span><span class="n">nroot_0d</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">y</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
  </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w">

</span><span class="k">function</span><span class="w"> </span><span class="n">nroot_2d</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">)])),</span><span class="w"> </span><span class="p">[</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)])</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w">
</span></code></pre></div></div>

<p>And use as follows:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot_0d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">)</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">])</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot_2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nb">reshape</span><span class="p">([</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]))</span><span class="w">
</span></code></pre></div></div>

<p>This will print:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">3</span><span class="mf">.0000000000000000</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span></code></pre></div></div>

<p>Or one can use <em>explicit-shape</em> arrays as
follows:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w">
  </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mf">1._dp</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w">
</span></code></pre></div></div>

<p>Use as follows:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">9._dp</span><span class="p">])</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">])</span><span class="w">
</span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">nroot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nb">reshape</span><span class="p">([</span><span class="mf">1._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">4._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">9._dp</span><span class="p">,</span><span class="w"> </span><span class="mf">10._dp</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]))</span><span class="w">
</span></code></pre></div></div>

<p>The output is the same as before:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">3</span><span class="mf">.0000000000000000</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span><span class="nl">1</span><span class="mf">.0000000000000000</span><span class="w">        </span><span class="mf">2.0000000000000000</span><span class="w">        </span><span class="mf">3.0000000000000000</span><span class="w">        </span><span class="mf">3.1622776601683795</span><span class="w">
</span></code></pre></div></div>


      <div class="container-flex">

        
          
            <a href="/pr/348/learn/best_practices/multidim_arrays" style="margin-right: auto;">
          
            <h3><i class="fas fa-arrow-circle-left"></i>
              Back
            </h3>
          </a>
        

        
          
          <a href="/pr/348/learn/best_practices/allocatable_arrays"
          style="margin-left: auto;">
            <h3>
              Next
              <i class="fas fa-arrow-circle-right"></i>
            </h3>
          </a>
          
        

      </div>

    </div>

  </div>
</section>


    <footer>
  <div class="container">
    <div class="col-wide">
    
      <a href="/pr/348/learn/">Learn</a>
      
        &middot;
      
    
      <a href="/pr/348/compilers/">Compilers</a>
      
        &middot;
      
    
      <a href="/pr/348/community/">Community</a>
      
        &middot;
      
    
      <a href="/pr/348/packages">Packages</a>
      
        &middot;
      
    
      <a href="/pr/348/news/">News</a>
      
    
    </div>

    <div class="col-narrow">
      This site's source is <a href="https://github.com/fortran-lang/fortran-lang.org/">hosted on GitHub</a>.
    </div>
  </div>
</footer>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
     

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="/pr/348/assets/js/fortranlang.js"></script>
    <script src="/pr/348/assets/js/page_nav.js"></script>
    <script src="/pr/348/assets/js/gh-contributors.js"></script>
    <script src="/pr/348/assets/js/package_search.js"></script>
    <script src="/pr/348/assets/js/package_tags.js"></script>
    <script>
      feather.replace()
    </script>
  </body>
</html>
