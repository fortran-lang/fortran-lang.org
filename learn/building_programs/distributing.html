<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Fortran Programming Language">
    <title>Distributing your programs - Fortran Programming Language</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.0/normalize.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css">
    <script src="https://unpkg.com/feather-icons"></script>
    <link href="/assets/css/main.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
    <link rel="canonical" href="https://fortran-lang.org/learn/building_programs/distributing" />
    <script src="https://kit.fontawesome.com/8d17d4fe97.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/2.0.2/octicons.min.css">
    <link rel="stylesheet" href="/assets/github-activity-0.1.5/github-activity-0.1.5.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.7.2/mustache.min.js"></script>
    <script type="text/javascript" src="/assets/github-activity-0.1.5/github-activity-0.1.5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js" integrity="sha256-TQq84xX6vkwR0Qs1qH5ADkP+MvH0W+9E7TdHJsoIQiM=" crossorigin="anonymous"></script>
    
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <header class="navbar">
	 
    <div class="container">
        <nav class="navbar">
	    <div class="container-fluid">
	    <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu" aria-expanded="false">
		    <span class="sr-only">Toggle navigation</span>
		    <img src="/assets/img/icons/icon-menu.svg" alt="Toggle navigation" class="navbar-top-align">
		</button>
		<a href="/" class="navbar-brand">
		    <img src="/assets/img/fortran_logo_256x256.png" id="navbar-logo" alt="Fortran">
		</a>
	    </div>
	    <div class="collapse navbar-collapse navbar-top-align" id="menu">
	        <ul class="nav navbar-nav navbar-right">
		
		    
		    <li class="current">
		    
		    <a href="/learn/">Learn</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/compilers/">Compilers</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/community/">Community</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/packages">Packages</a>
		    
			</li>
		
		    
		    <li>
		    
		    <a href="/news/">News</a>
		    
			</li>
		
		<li>
			<a  href="https://fortran-lang.discourse.group/" target="_blank">
			<i class="fab fa-discourse"></i> <i class="icon-link" >Discourse</i>
			</a>
		</li>
		<li>
			<a href="https://twitter.com/fortranlang" target="_blank">
				<i class="fab fa-twitter"></i> <i class="icon-link" >Twitter</i>
			</a>
		</li>
		<li>
			<a  href="https://github.com/fortran-lang" target="_blank">
				<i class="fab fa-github"></i> <i class="icon-link" >Github</i>
			</a>
		</li>
		<li>
			<a  href="/news.xml" target="_blank">
				<i class="fas fa-rss"></i> <i class="icon-link" >RSS Feed</i>
			</a>
		</li>
		</ul>
	    </div>
	    </div>
        </nav>
    </div>
</header>


<section class="front-section">
  <div class="container">

    <div class="col-fixed" id="pagenav-sidebar">

  <!-- Find parent book using page.permalink -->
  <!-- NB. This search is inefficient but simplifies
        the definition of book pages in learning.yml -->
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          
    
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
  

  <a href="/learn#book-index">
    <i class="fas fa-arrow-circle-left"></i>
    Back to Learn Fortran index 
  </a>

  <h3>
  <i class="fas fa-book"></i>
  Building programs</h3>

  <div class="content">
   <!-- If this book has multiple pages -->

    

    <ul>
    
    <!-- Add link to book introduction (index) -->
    
      <li><a href="/learn/building_programs">
        Introduction</a></li>
    

    <!-- List pages in this book -->
    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/compiling_source">
          Compiling the source code</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/linking_pieces">
          Linking the objects</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/runtime_libraries">
          Run-time libraries</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/include_files">
          Include files and modules</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/managing_libraries">
          Managing libraries (static and dynamic libraries)</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
          
          

      
        <li><a href="/learn/building_programs/build_tools">
          Build tools</a></li>
      

    
    
      <!-- Get page title from page metadata -->
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          

      
        <li>
          <b><a href="/learn/building_programs/distributing">
            Distributing your programs</a></b>
          <ul id="page-nav"></ul>
        </li>
        
        
        
      

    
    </ul>

  
</div>

</div>



    <div class="newsletter col-right">

      <h1>Distributing your programs</h1>

      <div style="margin-top: 0.5em; margin-bottom: 0.5em;">
        <i></i>
        
      </div>

      <p>When you distribute your programs, there are a number of options you can
choose from:</p>

<ol>
  <li>Distribute the entire source code</li>
  <li>Distribute a pre-built executable program</li>
  <li>Distribute static or dynamic libraries that people can use</li>
</ol>

<p><strong>Option 1: Distribute the entire source code</strong></p>

<p>By far the simplest - for you as a programmer - is this one: you leave it
up to the user to build it on their own machine. Unfortunately, that
means you will have to have a user-friendly build system in place and
the user will have to have access to suitable compilers. For build systems:
see the previous section.</p>

<p><strong>Option 2: Distribute a pre-built executable program</strong></p>

<p>A pre-built program that does not need to be customised, other than via its
input, will still need to come with the various run-time libraries and will
be specific to the operating system/environment it was built for.</p>

<p>The set of run-time libraries differs per operating system and compiler version.
For a freely available compiler like gfortran, the easiest thing is to ask the
user to install that compiler on their system. In the case of Windows: the Cygwin
environment may be called for.</p>

<p>Alternatively, you can supply copies of the run-time libraries together with your
program. Put them in the directory where they can be found at run-time.</p>

<p>Note: On Windows, the Intel Fortran comes with a set of <em>redistributable</em> libraries.
These will need to be made available.</p>

<p>In general: use a tool like “ldd” or “dependency walker” to find out what
libraries are required and consult the documentation of the compiler.</p>

<p>If your program does allow customisation, consider using dynamic libraries for this.
More is said about this below.</p>

<p><strong>Option 3: Distribute static or dynamic libraries that people can use</strong></p>

<p>This option is a combination of the first two options. It does put some burden on
the user, as they must create a main program that calls your routines in the
proper way, but they do not need to know much about the build system you used.
You will have to deal with the run-time libraries, though.</p>

<p>If you choose this option, besides the compiled libraries, you will also need to
supply the module intermediate files. These files are compiler-specific, but so are
the static libraries you build.</p>

<h2 id="distributing-the-tabulation-program">Distributing the tabulation program</h2>
<p>As shown above, the tabulation program can be built with the user-defined function
in a dynamic library. This enables you to:</p>

<ul>
  <li>Ship the executable (with the appropriate run-time libraries)</li>
  <li>Provide a skeleton version of the module, something like:</li>
</ul>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span><span class="w"> </span><span class="n">user_functions</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
</span><span class="k">contains</span><span class="w">

</span><span class="kt">real</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1">!DEC$ ATTRIBUTES DLLEXPORT :: f</span><span class="w">
    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">

    </span><span class="c1">! your function body goes here</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">user_functions</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>Provide a basic build script with a command like:</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gfortran <span class="nt">-o</span> <span class="k">function</span>.dll <span class="k">function</span>.f90 <span class="nt">-shared</span>
</code></pre></div></div>

<p>or:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ifort <span class="nt">-exe</span>:function.dll <span class="k">function</span>.f90 <span class="nt">-dll</span>
</code></pre></div></div>

<p>As said, you cannot control that the user has done the right thing - any
DLL “function.dll” with a function <code class="highlighter-rouge">f</code> would be accepted, but not necessarily
lead to a successful run.</p>

<p>An alternative set-up would be to change the main program into a subroutine
and have the function as an argument:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span><span class="w"> </span><span class="n">tabulation</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
</span><span class="k">contains</span><span class="w">

</span><span class="k">subroutine</span><span class="w"> </span><span class="n">tabulate</span><span class="p">(</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">)</span><span class="w">
    </span><span class="k">interface</span><span class="w">
        </span><span class="kt">real</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w">
            </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">interface</span><span class="w">

    </span><span class="c1">! your implementation goes here</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">tabulate</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">tabulation</span><span class="w">
</span></code></pre></div></div>

<p>Then provide a skeleton main program:</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">program</span><span class="w"> </span><span class="n">tabulate_f</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">tabulation</span><span class="w">

    </span><span class="k">call</span><span class="w"> </span><span class="n">tabulate</span><span class="p">(</span><span class="w"> </span><span class="n">func1</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="k">contains</span><span class="w">

</span><span class="kt">real</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">func1</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w">
    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">

    </span><span class="c1">! your function body goes here</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">func1</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">program</span><span class="w"> </span><span class="n">tabulate_f</span><span class="w">
</span></code></pre></div></div>

<p>The advantage is that the compiler can check the interface of the
function that is passed and that the user has more freedom in the use of the
functionality provided by your library.</p>


      <div class="container-flex">

        
          
            <a href="/learn/building_programs/build_tools" style="margin-right: auto;">
          
            <h3><i class="fas fa-arrow-circle-left"></i>
              Back
            </h3>
          </a>
        

        
          
        

      </div>

    </div>

  </div>
</section>


    <footer>
  <div class="container">
    <div class="col-wide">
    
      <a href="/learn/">Learn</a>
      
        &middot;
      
    
      <a href="/compilers/">Compilers</a>
      
        &middot;
      
    
      <a href="/community/">Community</a>
      
        &middot;
      
    
      <a href="/packages">Packages</a>
      
        &middot;
      
    
      <a href="/news/">News</a>
      
    
    </div>

    <div class="col-narrow">
      This site's source is <a href="https://github.com/fortran-lang/fortran-lang.github.io/">hosted on GitHub</a>.
    </div>
  </div>
</footer>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
     

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="/assets/js/fortranlang.js"></script>
    <script src="/assets/js/page_nav.js"></script>
    <script src="/assets/js/gh-contributors.js"></script>
    <script src="/assets/js/package_search.js"></script>
    <script src="/assets/js/package_tags.js"></script>
    <script>
      feather.replace()
    </script>
  </body>
</html>
